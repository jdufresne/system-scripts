- name: Enable Google Chrome YUM repository
  ini_file:
    path: /etc/yum.repos.d/google-chrome.repo
    section: google-chrome
    option: enabled
    value: "1"
    mode: 0644
  become: yes

- name: Install Google Chrome
  dnf:
    name:
      - google-chrome-stable
  become: yes

- name: Get latest ChromeDriver release
  uri:
    url: https://chromedriver.storage.googleapis.com/LATEST_RELEASE
    return_content: yes
  register: chromedriver_release

- name: Download ChromeDriver
  get_url:
    url: "https://chromedriver.storage.googleapis.com/{{ chromedriver_release.content }}/chromedriver_linux64.zip"
    dest: "{{ cache_dir }}/chromedriver_linux64-{{ chromedriver_release.content }}.zip"
  register: chromedriver

- name: Extract ChromeDriver
  unarchive:
    src: "{{ chromedriver.dest }}"
    dest: ~/.local/bin/
    remote_src: yes
